### Коэффициент удаленности поверхности от искомой (вес)
Функция \( f(distance, radius) \) определяет вес в зависимости от расстояния от искомой конструкции \( distance \) и радиуса поиска \( radius \):

$$
f(distance, radius) = 
\begin{cases} 
1, & \text{если } radius = 0 \\
e^{-\frac{distance}{radius}}, & \text{если } 0 \leq distance \leq radius \\
0, & \text{если } distance > radius
\end{cases}
$$

### Расстояние между двумя точками на сфероиде
Функция `Расстояния` вычисляет расстояние между двумя точками на сфероиде:

$$
\text{Расстояние}(\text{lat1}, \text{lon1}, \text{lat2}, \text{lon2}) = a \cdot \Delta\sigma
$$

где:
- \( a = 6371.0 \) км
- $$ \Delta\sigma = \text{atan2}\left(\frac{\sqrt{(\cos(\text{lat2\_rad}) \cdot \sin(\Delta\lambda))^2 + (\cos(\text{lat1\_rad}) \cdot \sin(\text{lat2\_rad}) - \sin(\text{lat1\_rad}) \cdot \cos(\text{lat2\_rad}) \cdot \cos(\Delta\lambda))^2}}{\sin(\text{lat1\_rad}) \cdot \sin(\text{lat2\_rad}) + \cos(\text{lat1\_rad}) \cdot \cos(\text{lat2\_rad}) \cdot \cos(\Delta\lambda)}\right) $$
- $$ \Delta\lambda = \text{lon2\_rad} - \text{lon1\_rad} $$


### Коэффициент длительности аренды
Коэффициент \( C \) вычисляется как отношение длительности аренды \( D \) к количеству дней в месяце \( M \):

$$
C = \frac{D}{M}
$$

где:
-  D = (Окончание аренды - Начало аренды) + 1
-  M = Количество дней в месяце

### Коэффициент Digital
Коэффициент \( C \) вычисляется в зависимости от типа конструкции:

$$
C = 
\begin{cases} 
1, & \text{для статики} \\
\frac{S \cdot N}{15 \cdot 288}, & \text{если тип конструкции - MF} \\
\frac{S \cdot N}{5 \cdot 1440}, & \text{для остальных}
\end{cases}
$$

где \( S \) - Хронометраж, \( N \) - Количество выходов в сутки.

### Основная логика
Расчет основывается на редневзвешенной стоимости:

- Если точки находятся в пределах поиска, то базовая стоимость вычисляется как фактическая стоимость конструкции из базы данных, деленная на коэффициенты длительности аренды, Digital и так далее (из той же базы).
$$
\text{Базовая стоимость} = \frac{\text{Фактическая стоимость}}{\text{Коэффициенты}}
$$
- Если найдена только одна запись, то средневзвешенная стоимость равна базовой стоимости.
- Если несколько конструкций из базы в пределах радиуса поиска, то средневзвешенная стоимость вычисляется как сумма произведений базовой стоимости и веса (удаленности от искомой) для каждой записи, деленная на сумму весов.
$$
\text{Базовая стоимость} = \frac{\sum \text{Базовая стоимость}\cdot{Вес}}{\sum \text{Вес}}
$$
- Если не найдены подходящие записи, то возвращается пустой результат, и конструкция отсеивается.